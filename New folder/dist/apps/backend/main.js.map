{"version":3,"file":"main.js","mappings":"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","sources":["webpack:///external commonjs \"@nestjs/common\"","webpack:///external commonjs \"@nestjs/core\"","webpack:///./src/app/app.module.ts","webpack:///external commonjs \"tslib\"","webpack:///external commonjs \"@nestjs/jwt\"","webpack:///external commonjs \"@nestjs/mongoose\"","webpack:///./src/app/app.controller.ts","webpack:///./src/app/app.service.ts","webpack:///./src/app/auth/auth.module.ts","webpack:///./src/app/auth/auth.service.ts","webpack:///external commonjs \"bcrypt\"","webpack:///./src/app/user/user.model.ts","webpack:///./src/app/auth/middleware/auth.middleware.ts","webpack:///./src/app/socket/socket.module.ts","webpack:///./src/app/socket/gateway/socket.gateway.ts","webpack:///external commonjs \"@nestjs/websockets\"","webpack:///./src/app/user/user.module.ts","webpack:///./src/app/user/user.controller.ts","webpack:///./src/app/user/user.service.ts","webpack:///external commonjs \"mongoose\"","webpack:///./src/app/user/user.dto.ts","webpack:///external commonjs \"class-validator\"","webpack:///./src/app/auth/guards/role.guard.ts","webpack:///webpack/bootstrap","webpack:///./src/main.ts"],"sourcesContent":["module.exports = require(\"@nestjs/common\");","module.exports = require(\"@nestjs/core\");","import { MiddlewareConsumer, Module } from \"@nestjs/common\";\nimport { JwtModule } from \"@nestjs/jwt\";\nimport { MongooseModule } from \"@nestjs/mongoose\";\nimport { AppController } from \"./app.controller\";\nimport { AppService } from \"./app.service\";\nimport { AuthModule } from \"./auth/auth.module\";\nimport { AuthMiddleware } from \"./auth/middleware/auth.middleware\";\nimport { SocketModule } from \"./socket/socket.module\";\nimport { UserModule } from \"./user/user.module\";\n\n@Module({\n  imports: [\n    MongooseModule.forRoot(\"mongodb://localhost/social\"),\n    JwtModule.register({\n      global: true,\n      secret: \"apple1234\",\n      signOptions: { expiresIn: \"24h\" },\n    }),\n    UserModule,\n    AuthModule,\n    SocketModule,\n  ],\n  controllers: [AppController],\n  providers: [AppService],\n})\nexport class AppModule {\n  configure(consumer: MiddlewareConsumer) {\n    consumer\n      .apply(AuthMiddleware)\n      .exclude(\"/user/signUp\", \"/user/signIn\")\n      .forRoutes(\"/api/user\");\n  }\n}\n","module.exports = require(\"tslib\");","module.exports = require(\"@nestjs/jwt\");","module.exports = require(\"@nestjs/mongoose\");","import { Controller, Get } from '@nestjs/common';\nimport { AppService } from './app.service';\n\n@Controller('hello')\nexport class AppController {\n  constructor(private readonly appService: AppService) {}\n\n  @Get()\n  getData() {\n    return this.appService.getData();\n  }\n}\n","import { Injectable } from '@nestjs/common';\n\n@Injectable()\nexport class AppService {\n  getData(): { message: string } {\n    return { message: 'Hello world ok by wht' };\n  }\n}\n","import { Module } from '@nestjs/common';\nimport { AuthService } from './auth.service';\nimport { MongooseModule } from '@nestjs/mongoose';\nimport { User, UserSchema } from '../user/user.model';\n\n@Module({\n  imports: [\n    MongooseModule.forFeature([{ name: User.name, schema: UserSchema }]),\n  ],\n  providers: [AuthService],\n  exports: [AuthService],\n})\nexport class AuthModule {}\n","import { Injectable } from '@nestjs/common';\nimport { JwtService } from '@nestjs/jwt';\nimport { UserI } from '../shared/user.interface';\nimport * as bcrypt from 'bcrypt';\nimport { Types } from 'mongoose';\n\n@Injectable()\nexport class AuthService {\n  constructor(private readonly _jwtService: JwtService) {}\n\n  async generateJwt(userId: Types.ObjectId): Promise<string> {\n    return this._jwtService.signAsync({ id: userId });\n  }\n\n  async hashPassword(password: string): Promise<string> {\n    return bcrypt.hash(password, 12);\n  }\n\n  async comparePasswords(\n    password: string,\n    storedPasswordHash: string\n  ): Promise<any> {\n    return bcrypt.compare(password, storedPasswordHash);\n  }\n\n  verifyJwt(jwt: string): Promise<any> {\n    return this._jwtService.verifyAsync(jwt);\n  }\n}\n","module.exports = require(\"bcrypt\");","import { Optional } from '@nestjs/common';\nimport { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\nimport { Document } from 'mongoose';\n\n@Schema({\n  collection: 'user_details',\n  timestamps: {\n    createdAt: 'created_at',\n    updatedAt: 'updated_at',\n  },\n})\nexport class User {\n  @Prop({ type: String })\n  name: string;\n\n  @Prop({ type: String })\n  email: string;\n\n  @Prop({ type: String })\n  password: string;\n\n  @Prop({ type: Boolean, default: false })\n  @Optional()\n  admin: boolean;\n}\n\nexport const UserSchema = SchemaFactory.createForClass(User);\n","import {\n  HttpException,\n  HttpStatus,\n  Injectable,\n  NestMiddleware,\n} from '@nestjs/common';\nimport { JwtService } from '@nestjs/jwt';\nimport { Request, Response, NextFunction } from 'express';\n\n@Injectable()\nexport class AuthMiddleware implements NestMiddleware {\n  constructor(private _jwtService: JwtService) {}\n\n  async use(req: Request, res: Response, next: NextFunction) {\n    try {\n      const [type, token] = req.headers['authorization'].split(' ');\n      if (type === 'Bearer') {\n        const payload = await this._jwtService.verifyAsync(token, {\n          secret: 'apple1234',\n        });\n        req['user'] = payload;\n      }\n      next();\n    } catch (err) {\n      console.log(err);\n      throw new HttpException('Unauthenticated', HttpStatus.UNAUTHORIZED);\n    }\n  }\n}\n","import { Module } from '@nestjs/common';\nimport { SocketGateway } from './gateway/socket.gateway';\n\n@Module({\n  providers: [SocketGateway],\n})\nexport class SocketModule {}\n","import {\n  OnGatewayConnection,\n  OnGatewayDisconnect,\n  SubscribeMessage,\n  WebSocketGateway,\n  WebSocketServer,\n} from \"@nestjs/websockets\";\nimport { Socket } from \"socket.io\";\n// import { AuthService } from \"../../auth/auth.service\";\n\n@WebSocketGateway({ cors: true })\nexport class SocketGateway implements OnGatewayConnection, OnGatewayDisconnect {\n  constructor() {}\n  @WebSocketServer()\n  private server;\n\n  @SubscribeMessage(\"message\")\n  handleMessage(client: any, payload: any) {\n    this.server.emit(\"message\", \"test\");\n  }\n\n  async handleConnection(socket: Socket) {\n    // const decodedToken = await this._authService.verifyJwt(\n    //   socket.handshake.headers.authorization\n    // );\n\n    console.log(\"Connected\");\n    this.server.emit(\"message\", \"I am Connected\");\n  }\n\n  handleDisconnect() {\n    console.log(\"Disconnected\");\n    this.server.emit(\"message\", \"Disconnected\");\n  }\n}\n","module.exports = require(\"@nestjs/websockets\");","import { Module } from \"@nestjs/common\";\nimport { MongooseModule } from \"@nestjs/mongoose\";\nimport { AuthModule } from \"../auth/auth.module\";\nimport { UserController } from \"./user.controller\";\nimport { User, UserSchema } from \"./user.model\";\nimport { UserService } from \"./user.service\";\n\n@Module({\n  imports: [\n    MongooseModule.forFeature([{ name: User.name, schema: UserSchema }]),\n    AuthModule,\n  ],\n  controllers: [UserController],\n  providers: [UserService],\n})\nexport class UserModule {}\n","import {\n  Body,\n  Controller,\n  Get,\n  HttpException,\n  HttpStatus,\n  Post,\n  Request,\n  UseGuards,\n} from '@nestjs/common';\nimport { UserService } from './user.service';\nimport {\n  CreateUserRequest,\n  LoginUserRequest,\n  UserResponseDto,\n} from './user.dto';\nimport { LoginResponseI } from '../shared/user.interface';\nimport { JwtAuthGuard } from '../auth/guards/jwt.guard';\nimport { RolesGuard } from '../auth/guards/role.guard';\n\n@Controller('user')\nexport class UserController {\n  constructor(private userService: UserService) {}\n\n  @Post('signUp')\n  async createUser(\n    @Body() createUserRequest: CreateUserRequest\n  ): Promise<UserResponseDto | HttpException> {\n    try {\n      const createdUser = await this.userService.createUser(createUserRequest);\n      return new UserResponseDto(createdUser);\n    } catch (err) {\n      if (err instanceof HttpException) {\n        throw err;\n      }\n      throw new HttpException(\n        'Unable to save user',\n        HttpStatus.INTERNAL_SERVER_ERROR,\n        { cause: new Error(err) }\n      );\n    }\n  }\n\n  @Post('signIn')\n  async signIn(\n    @Body() loginUserRequest: LoginUserRequest\n  ): Promise<LoginResponseI> {\n    const jwt: string = await this.userService.signInUser(loginUserRequest);\n    return {\n      access_token: jwt,\n      token_type: 'JWT',\n      expires_in: 10000,\n    };\n  }\n\n  @UseGuards(RolesGuard)\n  @Get('profile')\n  async getProfile(@Request() req): Promise<string> {\n    return req.user.id;\n  }\n}\n","import { HttpException, HttpStatus, Injectable } from '@nestjs/common';\nimport { CreateUserRequest, LoginUserRequest } from './user.dto';\nimport { InjectModel } from '@nestjs/mongoose';\nimport { User } from './user.model';\nimport { Model } from 'mongoose';\nimport { AuthService } from '../auth/auth.service';\nimport { UserI } from '../shared/user.interface';\n\n@Injectable()\nexport class UserService {\n  constructor(\n    @InjectModel(User.name) private readonly userModel: Model<User>,\n    private authService: AuthService\n  ) {}\n\n  async createUser(createUserRequest: CreateUserRequest) {\n    const user = await this.userModel.findOne({\n      email: createUserRequest.email,\n    });\n    if (user) {\n      throw new HttpException('Email already exists', HttpStatus.CONFLICT);\n    }\n    const passwordHash: string = await this.hashPassword(\n      createUserRequest.password\n    );\n    const userData = {\n      email: createUserRequest.email,\n      name: createUserRequest.name,\n      admin: createUserRequest?.admin,\n      password: passwordHash,\n    };\n    const newUser = new this.userModel(userData);\n    const newUserData = await newUser.save();\n    return newUserData;\n  }\n\n  async signInUser(user: LoginUserRequest): Promise<string> {\n    try {\n      const foundUser = await this.userModel.findOne({ email: user.email });\n      if (foundUser) {\n        const matches: boolean = await this.validatePassword(\n          user.password,\n          foundUser.password\n        );\n        if (matches) {\n          return this.authService.generateJwt(foundUser._id);\n        } else {\n          throw new HttpException(\n            'Login was not successfull, wrong credentials',\n            HttpStatus.UNAUTHORIZED\n          );\n        }\n      } else {\n        throw new HttpException(\n          'Login was not successfull, wrong credentials',\n          HttpStatus.UNAUTHORIZED\n        );\n      }\n    } catch (err) {\n      console.log(err);\n\n      throw new HttpException('User not found', HttpStatus.NOT_FOUND);\n    }\n  }\n\n  private async hashPassword(password: string): Promise<string> {\n    return this.authService.hashPassword(password);\n  }\n\n  private async validatePassword(\n    password: string,\n    storedPasswordHash: string\n  ): Promise<any> {\n    return this.authService.comparePasswords(password, storedPasswordHash);\n  }\n}\n","module.exports = require(\"mongoose\");","import { IsNotEmpty, IsEmail, IsString, IsBoolean } from 'class-validator';\nimport { User } from './user.model';\n\nexport class CreateUserRequest {\n  @IsString()\n  @IsNotEmpty()\n  name: string;\n\n  @IsEmail()\n  @IsNotEmpty()\n  email: string;\n\n  @IsString()\n  @IsNotEmpty()\n  password: string;\n\n  @IsBoolean()\n  admin?: boolean;\n}\n\nexport class LoginUserRequest {\n  @IsEmail()\n  email: string;\n\n  @IsString()\n  @IsNotEmpty()\n  password: string;\n}\n\nexport class UserResponseDto {\n  readonly email: string;\n\n  constructor(user: User) {\n    this.email = user.email;\n  }\n}\n","module.exports = require(\"class-validator\");","import {\n  Injectable,\n  CanActivate,\n  ExecutionContext,\n  HttpException,\n  HttpStatus,\n} from '@nestjs/common';\nimport { User } from '../../user/user.model';\nimport { Model } from 'mongoose';\nimport { InjectModel } from '@nestjs/mongoose';\n\n@Injectable()\nexport class RolesGuard implements CanActivate {\n  constructor(\n    @InjectModel(User.name) private readonly _userModel: Model<User>\n  ) {}\n  async canActivate(context: ExecutionContext): Promise<boolean> {\n    try {\n      const { user } = context.switchToHttp().getRequest();\n      const userDetails = await this._userModel.findById(user.id);\n      if (userDetails && userDetails.admin === true) {\n        return true;\n      } else {\n        throw new HttpException('Unauthorized', HttpStatus.UNAUTHORIZED);\n      }\n    } catch (err) {\n      if (err instanceof HttpException) {\n        throw err;\n      }\n      throw new HttpException(\n        'Something went wrong',\n        HttpStatus.INTERNAL_SERVER_ERROR\n      );\n    }\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","/**\n * This is not a production server yet!\n * This is only a minimal backend to get started.\n */\n\nimport { Logger } from '@nestjs/common';\nimport { NestFactory } from '@nestjs/core';\n\nimport { AppModule } from './app/app.module';\n\nasync function bootstrap() {\n  const app = await NestFactory.create(AppModule);\n  const globalPrefix = 'api';\n  app.setGlobalPrefix(globalPrefix);\n  const port = process.env.PORT || 3000;\n  await app.listen(port);\n  Logger.log(\n    `🚀 Application is running on: http://localhost:${port}/${globalPrefix}`\n  );\n}\n\nbootstrap();\n"],"names":[],"sourceRoot":""}